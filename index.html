<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>نموذج بيانات الإفراج الجمركي </title>
    <style>
        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --success: #10b981;
            --danger: #ef4444;
            --bg-gradient: linear-gradient(135deg, #e0eafc 0%, #cfdef3 100%);
            --glass-shine: linear-gradient(170deg, rgba(255,255,255,0.4) 0%, rgba(255,255,255,0) 60%, rgba(255,255,255,0.1) 100%);
        }

        body {
            background: var(--bg-gradient);
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0;
            padding: 20px;
        }

        .container {
            background: linear-gradient(#79e1e9, #63b5b3);
            width: 100%;
            max-width: 1000px;
            padding: 30px 40px;
            border-radius: 40px;
            box-shadow: 0 20px 45px rgba(0,0,0,0.15);
        }

        /* إخفاء عداد الأرقام الافتراضي */
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
        input[type=number] { -moz-appearance: textfield; }

        /* إخفاء placeholder عند الوقوف */
        input:focus::placeholder { color: transparent; }
        
        /* إخفاء كلمات حروف السيارة معاً عند التركيز على أي منها */
        .plate-focus-active .plate-char::placeholder { color: transparent !important; }

        .header-logo { display: flex; justify-content: center; margin-bottom: 10px; }
        .logo-wrapper { position: relative; border-radius: 10px; display: inline-block; overflow: hidden; }
        .logo-wrapper img { max-height: 90px; filter: drop-shadow(0px 4px 6px rgba(0,0,0,0.1)); }
        
        .logo-wrapper::before {
            content: ""; position: absolute; top: 0; left: -150%; width: 50%; height: 100%;
            background: linear-gradient(to right, rgba(255,255,255,0) 0%, rgba(255,255,255,0.6) 50%, rgba(255,255,255,0) 100%);
            transform: skewX(-25deg); animation: shine 3s infinite;
        }
        @keyframes shine { 0% { left: -150%; } 20% { left: 150%; } 100% { left: 150%; } }

        h2 { text-align: center; color: #1e293b; margin-bottom: 30px; border-bottom: 2px solid var(--primary); width: 100%; padding-bottom: 10px; }

        .row { display: flex; flex-wrap: wrap; gap: 20px; margin-bottom: 20px; }
        .form-group { flex: 1; min-width: 200px; display: flex; flex-direction: column; }
        label { font-size: 17px; font-weight: 600; color: #1e293b; margin-bottom: 8px; }
        label::after { content: "    *"; color: #dc2626; }
#carLabel {
            padding-right: 110px; /* زيد الرقم ده عشان تمشي شمال */
            padding-left: 0px;  /* زيد الرقم ده عشان تمشي يمين */
            display: block;
        }
        input, select { padding: 12px; border: 1px solid rgba(0,0,0,0.1); border-radius: 8px; font-size: 18px; transition: all 0.3s ease; background: rgba(255,255,255,0.9); }
        input:focus { border-color: var(--primary); outline: none; box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.15); }
        input:disabled, select:disabled { background-color: rgba(0, 0, 0, 0.08); cursor: not-allowed; opacity: 0.7; }

        .plate-container { display: flex; gap: 10px; direction: ltr; }
        .plate-char { width: 15px; text-align: center; font-weight: bold; }
        .plate-num { width: 70px; text-align: center; font-weight: bold; }

        /* الأزرار */
        .btn { 
            padding: 12px 24px; border: 1px solid rgba(255, 255, 255, 0.3); border-radius: 12px; cursor: pointer; font-weight: 700; transition: all 0.3s;
            backdrop-filter: blur(4px); background-image: var(--glass-shine); box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .btn:hover { transform: translateY(-2px); filter: brightness(0.85); box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2); }
        .btn:active { transform: translateY(1px); }

        .btn-check { background-color: var(--primary); color: white; margin-top: 31px; height: 48  px; width: 140px; }
        .btn-add { background-color: var(--success); color: white; }
        .btn-delete { background-color: var(--danger); color: white; }
        .btn-submit { background-color: var(--success); color: white; flex: 2; padding: 15px; font-size: 18px; }
        .btn-reset { background-color: var(--danger); color: white; flex: 1; padding: 15px; font-size: 18px; }

        .glass-panel {
            background: rgba(255, 255, 255, 0.2); backdrop-filter: blur(12px); padding: 25px; border-radius: 15px; border: 1px solid rgba(255, 255, 255, 0.4);
        }

        .checkbox-group { display: flex; align-items: center; gap: 10px; margin-top: 10px; cursor: pointer; color: #1e293b; font-weight: 600; }

        /* ListBox */
        #listBox {
            width: 100%; height: 200px; margin: 25px 0; border: 2px solid rgba(255, 255, 255, 0.5); border-radius: 15px; padding: 10px; font-size: 18px; 
            background: rgba(255, 255, 255, 0.8); outline: none; overflow-y: scroll; scrollbar-width: none;
        }
        #listBox::-webkit-scrollbar { display: none; }
        #listBox option { padding: 12px; border-radius: 10px; margin-bottom: 5px; transition: 0.2s; }
        #listBox option:checked { background: rgba(255, 255, 255, 0.4) !important; color: #1e293b; backdrop-filter: blur(15px); border: 1px solid var(--primary); }

        .footer-btns { display: flex; gap: 20px; border-top: 2px solid rgba(255,255,255,0.3); padding-top: 25px; }
    </style>
</head>
<body>

<div class="container">
    <div class="header-logo">
        <div class="logo-wrapper"><img src="https://i.ibb.co/dsPpW1Jz/scct-logo-hd-1.webp"></div>
    </div>

    <h2>نموذج بيانات الإفراج الجمركي</h2>
    
    <div class="row">
        <div class="form-group">
            <label>رقم الإفراج</label>
            <input type="number" id="releaseNum" placeholder="أدخل الرقم">
        </div>
        <div class="form-group">
            <label>سنة الإفراج</label>
            <input type="number" id="releaseYear" placeholder="2026">
        </div>
        <div class="form-group">
            <label>نوع الإفراج</label>
            <select id="releaseType">
                <option value="" disabled selected>اختر النوع</option>
                <option>نهائي</option><option>سماح مؤقت</option><option>دروباك</option>
                <option>إعادة تصدير</option><option>مرحلة أولى</option>
            </select>
        </div>
        <div class="form-group">
            <label>جمرك الإرسال</label>
            <select id="customsOffice">
                <option value="" disabled selected>اختر الجمرك</option>
                <option>اسكندرية</option><option>بورسعيد</option><option>شرق بورسعيد</option>
            </select>
        </div>
        <button class="btn btn-check" onclick="checkData()">فحص البيانات</button>
    </div>

    <div class="row">
        <div class="form-group">
            <label>التوكيل</label>
            <select id="agency">
                <option value="" disabled selected>اختر التوكيل</option>
                <option>MAE</option><option>MSC</option><option>CMA</option>
            </select>
        </div>
        <div class="form-group">
            <label>الواجهة النهائية</label>
            <input type="text" id="destination" placeholder="جهة الوصول">
        </div>
        <div class="form-group">
            <label>اسم العميل</label>
            <select id="clientName">
                <option value="" disabled selected>اختر العميل</option>
                <option>مصر للصباغة والتجهيز</option><option>المصرية للتجارة</option>
            </select>
        </div>
    </div>

    <div class="row">
        <div class="form-group">
            <label>نوع المشمول</label>
            <input type="text" id="cargoType" placeholder="وصف البضاعة">
        </div>
        <div class="form-group">
            <label>الكمية الإجمالية</label>
            <div style="display: flex; gap: 8px;">
                <input type="number" id="totalQty" placeholder="العدد" style="flex:1">
                <select id="qtyUnit" style="flex:1">
                    <option value="" disabled selected>الوحدة</option>
                    <option>بالتة</option><option>طرد</option><option>صندوق</option>
                </select>
            </div>
            <label class="checkbox-group">
                <input type="checkbox" id="postAuditCheck" onchange="toggleQtyFields()">
                <span>الكمية بعد الكشف</span>
            </label>
        </div>
    </div>

    <div class="row glass-panel">
        <div class="form-group">
            <label>رقم الحاوية</label>
            <input type="text" id="containerNum" maxlength="11" placeholder="MSCU1234567" 
                   oninput="validateContainer(this)">
        </div>
        <div class="form-group">
<label id="carLabel">رقم السيارة</label>
            <div class="plate-container" id="plateContainer">
                <input type="text" maxlength="1" class="plate-char" id="c3" placeholder="ج" oninput="validateArabic(this)" onfocus="activatePlateFocus()" onblur="deactivatePlateFocus()">
                <input type="text" maxlength="1" class="plate-char" id="c2" placeholder="ب" oninput="validateArabic(this)" onfocus="activatePlateFocus()" onblur="deactivatePlateFocus()">
                <input type="text" maxlength="1" class="plate-char" id="c1" placeholder="أ" oninput="validateArabic(this)" onfocus="activatePlateFocus()" onblur="deactivatePlateFocus()">
                <input type="text" maxlength="4" class="plate-num" id="pNum" placeholder="1234" oninput="validateNumbers(this)">
            </div>
        </div>
        <div style="display:flex; align-items:flex-end; gap:15px;">
            <button class="btn btn-add" onclick="addItem()">إضافة حاوية</button>
            <button class="btn btn-delete" onclick="removeItem()">حذف</button>
        </div>
    </div>

    <select id="listBox" size="5"></select>

    <div class="footer-btns">
        <button class="btn btn-submit" onclick="submitFinal()">اعتماد الشهادة </button>
        <button class="btn btn-reset" onclick="resetForm()">مسح البيانات</button>
    </div>
</div>

<script>
    // --- 1. قيود الإدخال (Validation) ---

    // الحاوية: إنجليزي وأرقام فقط
    function validateContainer(el) {
        el.value = el.value.toUpperCase().replace(/[^A-Z0-9]/g, '');
    }

    // حروف السيارة: عربي فقط وانتقال تلقائي
    function validateArabic(el) {
        el.value = el.value.replace(/[^\u0621-\u064A]/g, '');
        if (el.value.length === 1) {
            const next = el.previousElementSibling;
            if (next && next.classList.contains('plate-char')) next.focus();
            else if (!next) document.getElementById('pNum').focus();
        }
    }

    // أرقام السيارة: أرقام فقط
    function validateNumbers(el) {
        el.value = el.value.replace(/[^0-9]/g, '');
    }

    // --- 2. منطق إخفاء الكلمات الإرشادية الذكي ---
    function activatePlateFocus() {
        document.getElementById('plateContainer').classList.add('plate-focus-active');
    }
    function deactivatePlateFocus() {
        setTimeout(() => {
            const activeEl = document.activeElement;
            if (!activeEl || !activeEl.classList.contains('plate-char')) {
                document.getElementById('plateContainer').classList.remove('plate-focus-active');
            }
        }, 50);
    }

    // --- 3. إدارة الكمية بعد الكشف ---
    function toggleQtyFields() {
        const isChecked = document.getElementById('postAuditCheck').checked;
        const qty = document.getElementById('totalQty');
        const unit = document.getElementById('qtyUnit');
        qty.disabled = unit.disabled = isChecked;
        if (isChecked) { qty.value = ""; unit.selectedIndex = 0; }
    }

    // --- 4. فحص البيانات (تجريبي) ---
    function checkData() {
    // جلب القيم من المدخلات
    const rNum = document.getElementById('releaseNum').value;
    const rYear = document.getElementById('releaseYear').value;
    const rType = document.getElementById('releaseType').value;
    const customs = document.getElementById('customsOffice').value; // جمرك الإرسال

    // الشرط الجديد: رقم الإفراج 1234 وَ السنة 2026 وَ النوع نهائي وَ الجمرك اسكندرية
    if (rNum === "1234" && rYear === "2026" && rType === "نهائي" && customs === "اسكندرية") {
        
        document.getElementById('agency').value = "MAE";
        document.getElementById('destination').value = "ميناء الإسكندرية";
        document.getElementById('clientName').value = "مصر للصباغة والتجهيز";
        document.getElementById('cargoType').value = "أقمشة منسوجة";
        document.getElementById('totalQty').value = "45";
        document.getElementById('qtyUnit').value = "بالتة";
    } else {
        alert("لم يتم العثور على بيانات تطابق هذه المدخلات. برجاء التأكد من (الرقم، السنة، النوع، والجمرك).");
    }
}

    // --- 5. الإضافة والحذف من القائمة ---
  function addItem() {
    const cont = document.getElementById('containerNum').value;
    const p1 = document.getElementById('c1').value;
    const p2 = document.getElementById('c2').value;
    const p3 = document.getElementById('c3').value;
    const pN = document.getElementById('pNum').value;
    
    // 1. التحقق من رقم الحاوية المحدد (Blocked)
    if (cont.toLowerCase() === "mrku1234567") {
        alert("لا يوجد بيانات للحاوية");
        return;
    }

    // 2. التحقق من طول رقم الحاوية (11 حرف على الأقل)
    if (cont.length < 11) {
        alert("يجب أن يتكون رقم الحاوية من 11 حرف ورقم على الأقل!");
        return;
    }

    // 3. التحقق من عدد أرقام السيارة (3 على الأقل)
    if (pN.length < 3) {
        alert("يجب أن يتكون رقم السيارة من 3 أرقام على الأقل!");
        return;
    }

    // 4. التحقق من عدد حروف السيارة (حرفين على الأقل)
    const allChars = (p1 + p2 + p3).trim();
    if (allChars.length < 2) {
        alert("يجب إدخال حرفين للسيارة على الأقل!");
        return;
    }

    // تنفيذ الإضافة للقائمة
    const lb = document.getElementById('listBox');
    const entry = `${lb.options.length + 1}) حاوية: ${cont} || سيارة: [ ${pN} | ${p1} ${p2} ${p3} ]`;
    const opt = document.createElement("option");
    opt.text = entry;
    lb.add(opt);

    // تفريغ الخانات بعد الإضافة
    document.getElementById('containerNum').value = "";
    document.getElementById('c1').value = ""; 
    document.getElementById('c2').value = "";
    document.getElementById('c3').value = ""; 
    document.getElementById('pNum').value = "";
    
    // إعادة حالة الكلمات الإرشادية للوضع الطبيعي بعد الإضافة
    document.getElementById('plateContainer').classList.remove('plate-focus-active');
}

// تحديث وظيفة إخفاء الكلمات الإرشادية (Placeholders) عند الكتابة
// تأكد أنك تستدعي هذه الدالة في HTML عبر oninput في خانات الحروف
function handlePlatePlaceholder() {
    const p1 = document.getElementById('c1').value;
    const p2 = document.getElementById('c2').value;
    const p3 = document.getElementById('c3').value;
    const container = document.getElementById('plateContainer');

    // إذا كتبت حرف واحد على الأقل في أي خانة، تختفي الكلمات الإرشادية من الباقي
    if (p1) {
        container.classList.add('plate-focus-active');
    } else {
        container.classList.remove('plate-focus-active');
    }
}
    function removeItem() {
        const lb = document.getElementById('listBox');
        if (lb.selectedIndex >= 0) {
            lb.remove(lb.selectedIndex);
            // إعادة ترقيم القائمة
            for (let i = 0; i < lb.options.length; i++) {
                let text = lb.options[i].text;
                lb.options[i].text = (i + 1) + text.substring(text.indexOf(')'));
            }
        }
    }

    function submitFinal() { 
        if (document.getElementById('listBox').options.length === 0) {
            alert("برجاء إضافة حاوية واحدة على الأقل!");
            return;
        }
        alert('تم اعتماد الشهادة الجمركية بنجاح'); 
    }

    function resetForm() { 
        if(confirm("هل تريد مسح كافة البيانات والبدء من جديد؟")) location.reload(); 
    }
</script>

</body>
</html>